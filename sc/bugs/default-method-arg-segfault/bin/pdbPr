#! /usr/bin/env starta
/*--*- Java -*---------------------------------------------------------------*\
**$Author: saulius $
**$Date: 2017-05-08 17:53:14 +0300 (Mon, 08 May 2017) $ 
**$Revision: 3479 $
**$URL: svn+ssh://saulius-grazulis.lt/home/saulius/svn-repositories/paskaitos/VU/software/trunk/bioinformatika-III-assignments/bin/pdbPr $
\*---------------------------------------------------------------------------*/
//*
// Starta programa, kuri suranda PDB faile pateiktų peptidų chi1
// ir chi2 kampus ir išvesda juos į savo standartinę išvestį.
//
// Programos iškvietimas:
// pdbchi1chi2 < 1zyx.pdb
// pdbchi1chi2 1zyx.pdb 2zyx*.pdb
//
//**

pragma prepend "$P/lib/starta";
    
use std;
use Strings;

var Id = "$Id: pdbPr 3479 2017-05-08 14:53:14Z saulius $";

. "#", Id[1:-2];

// Flag which file format we are currently reading:
type format = enum byte( PDB, PDBx );
var current_format = PDB format;

while(<>) {
    if( strstart( "data_", $_ )) {
        current_format = PDBx format;
        continue;
    }
    if( strstart( "HEADER", $_ ) || strstart( "CRYST1", $_ ) ) {
        current_format = PDB format;
        continue;
    }
    if( current_format == PDB format && strstart( "ATOM  ", $_ ) ||
        current_format == PDBx format && strstart( "ATOM", $_ ) ||
        strstart( "HETATM", $_ )) {
        . $_;
    }
}
